# AUTOGENERATED ${timestamp()}
provider "aws" {
  alias  = "${region}"
  region = "${region}"
}

%{ for idx, instance in instances ~}
# Name: ${try(instance.tags["Name"], "NoName")}
resource "aws_ec2_tag" "ec2_${instance.id}" {
  for_each = {
    %{ for tag_n, tag_v in instance.tags ~}
    "${tag_n}" : "${tag_v}"
    %{ endfor ~}
  }
  resource_id = "${instance.id}"
  key         = each.key
  value       = each.value
}

%{ endfor ~}